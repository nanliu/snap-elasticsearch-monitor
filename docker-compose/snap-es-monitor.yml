version: '2'
services:
  main:
    build: ./snap-elasticsearch-monitor
    container_name: snap-elasticsearch-monitor
    environment:
      - SNAP_VERSION='0.16.1'
      - FILE_PUB_PLUGIN_VER='2'
      - ELASTICSEARCH_COL_PLUGIN_VER='3'
      - INFLUXDB_PUB_PLUGIN_VER='15'
    depends_on:
      - influxdb
    extra_hosts:
      - "snap-elasticsearch:192.168.99.100"
  influxdb:
    container_name: influxdb
    image: tutum/influxdb:latest
    ports:
      - "8083:8083"
      - "8086:8086"
    expose:
      - "8083" 
      - "8086"
    environment:
      - PRE_CREATE_DB=k8s
  grafana:
    container_name: grafana
    image: grafana/grafana:latest
    ports:
      - "3000:3000"
    expose:
      - "3000" 
    links:
      - influxdb
networks:
  default:
    external:
      name: snap-monitor-network
